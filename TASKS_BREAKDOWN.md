–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –∑–∞–¥–∞—á –ø–æ Operabot

–ù–∏–∂–µ —Ç–≤–æ—è ¬´—Å–≤–∞–ª–∫–∞¬ª —Ä–∞–∑–ª–æ–∂–µ–Ω–∞ –ø–æ –ª–æ–≥–∏—á–µ—Å–∫–∏–º –±–ª–æ–∫–∞–º.
–ù–∏—á–µ–≥–æ –ø–æ —Å–º—ã—Å–ª—É –Ω–µ –≤—ã–∫–∏–¥—ã–≤–∞–ª: –¥—É–±–ª–∏ —Å–≤–µ–¥–µ–Ω—ã, –¥–µ—Ç–∞–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å–∏ –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞.

‚∏ª

–ë–õ–û–ö A. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ –∏ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ (—Ç–µ–∫—É—â–µ–µ —è–¥—Ä–æ –±–æ—Ç–∞)

A1. –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ —Å–µ–∫—Ä–µ—Ç—ã (–∫—Ä–∏—Ç–∏—á–Ω–æ) ‚Äî ‚úÖ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

–¶–µ–ª—å: –µ–¥–∏–Ω—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω—Ñ–∏–≥–æ–º, –±–µ–∑ —É—Ç–µ—á–µ–∫ —Ç–æ–∫–µ–Ω–æ–≤ –∏ –∫–ª—é—á–µ–π. –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `config.py`, —Ç–∞–º –∂–µ –¥–æ–±–∞–≤–ª–µ–Ω –±–ª–æ–∫ `task_queue_config` –¥–ª—è –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á; –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç –≥–æ—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –±–æ–ª—å—à–µ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç `os.getenv`. –í `bot.py` —Ç–æ–∫–µ–Ω Telegram –±–µ—Ä—ë—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∏–∑ `config.telegram_token`, –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∏ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, –∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î/–æ—á–µ—Ä–µ–¥–∏ –∏ OpenAI –Ω–µ –≤—ã–≤–æ–¥–∏—Ç —Å–µ–∫—Ä–µ—Ç—ã –≤ –ª–æ–≥–∞—Ö. –°—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç—ã (hash_role_passwords, project_summary, analyze_project –∏ —Ç.–¥.) –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ –æ–±—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –ø–æ—ç—Ç–æ–º—É –µ–¥–∏–Ω—ã–π –º–æ–¥—É–ª—å –≤—ã–ø–æ–ª–Ω–µ–Ω –∏ –∑–∞—â–∏—â–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.

‚∏ª

A2. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö (–∫—Ä–∏—Ç–∏—á–Ω–æ) ‚Äî üöß —á–∞—Å—Ç–∏—á–Ω–æ –≥–æ—Ç–æ–≤–æ

–¶–µ–ª—å: –æ–¥–∏–Ω DatabaseManager –∏ –µ–¥–∏–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è/—Ä–µ—Ç—Ä–∞–µ–≤/–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

–°—Ç–∞—Ç—É—Å —Å–µ–π—á–∞—Å:
	‚Ä¢	–°–æ–∑–¥–∞–Ω db/connection.py, —É–¥–∞–ª–µ–Ω—ã db_helpers.py –∏ —Ä—É—á–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.
	‚Ä¢	–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –º–æ–¥—É–ª–µ–π (–±–æ—Ç, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, openai_telebot, db_utils, db_setup) —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π DatabaseManager.
	‚Ä¢	Runtime-DDL –æ—Ç–∫–ª—é—á—ë–Ω; –º–µ—Ç–æ–¥—ã create_tables/initialize_db —Ç–µ–ø–µ—Ä—å –±—Ä–æ—Å–∞—é—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ –Ω–∞–ø–æ–º–∏–Ω–∞—é—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
	‚Ä¢	–ù—É–∂–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —É—Ç–∏–ª–∏—Ç—ã –∏ –≤–Ω–µ–¥—Ä–∏—Ç—å execute_with_retry –ø–æ–≤—Å–µ–º–µ—Å—Ç–Ω–æ.

–ó–∞–¥–∞—á–∏:
	1.	–û—Å—Ç–∞–≤–∏—Ç—å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π DatabaseManager, –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤ create_pool –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
	2.	–£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å:
	‚Ä¢	db_manager.py
	‚Ä¢	database_manager.py
	‚Ä¢	db_utils.py
	‚Ä¢	–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏.
	3.	–î–æ–±–∞–≤–∏—Ç—å —Ä–µ—Ç—Ä–∞–∏ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–æ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö (—Ç–µ–ª–µ—Ñ–æ–Ω—ã, –¥–∞—Ç—ã, extension –∏ —Ç.–¥.).
	4.	–û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Å—å –∫–æ–¥ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –µ–¥–∏–Ω–æ–π —Ñ–∞–±—Ä–∏–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑ db/connection.py.
	5.	–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é execute_with_retry(query, params, retries=3) –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –µ—ë –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö.
	6.	–î–æ–±–∞–≤–∏—Ç—å –ª–∏–Ω—Ç–µ—Ä/—Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä—è–º—ã—Ö aiomysql.create_pool –≤–Ω–µ –µ–¥–∏–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞.

–ü–æ–¥–∑–∞–¥–∞—á–∏ (–¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è):
	1.	–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ç–µ–∫—É—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–±–æ—Ç, openai_telebot, –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã) –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã –∏–º –Ω—É–∂–Ω—ã.
	2.	–í—ã–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ —Ñ–∞–±—Ä–∏–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ë–î –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –≤ db/connection.py.
	3.	–û–±–Ω–æ–≤–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ–∞–±—Ä–∏–∫–∏ –∏ —É–¥–∞–ª–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∫–ª–∞—Å—Å—ã.
	4.	–í–≤–µ—Å—Ç–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π (—Ç–µ–ª–µ—Ñ–æ–Ω—ã, –¥–∞—Ç—ã, —Å—Ç–∞—Ç—É—Å–Ω—ã–µ –ø–æ–ª—è) –ø–µ—Ä–µ–¥ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ–π –≤ SQL.

–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–∑ –∫–æ–¥-—Ä–µ–≤—å—é:
	‚Ä¢	–°–µ–π—á–∞—Å –µ—Å—Ç—å: db_module.py, db_manager.py, database_manager.py, db_utils.py, operator_data.py ‚Äî —Ä–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –ë–î, –¥—É–±–ª–∏ SQL –∏ —Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç.
	‚Ä¢	DatabaseManager.create_pool –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–æ acquire(), —á—Ç–æ –¥–∞—ë—Ç RuntimeError: –ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω.
	‚Ä¢	operator_data.py:292-299 –ø–µ—Ä–µ–¥–∞—ë—Ç –Ω–µ–≤–µ—Ä–Ω–æ–µ —á–∏—Å–ª–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ SQL (CALL ... WHERE called_info LIKE %s).

‚∏ª

A3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–ª–æ–∫–∏—Ä—É—é—â–∏–π TelegramErrorHandler (–∫—Ä–∏—Ç–∏—á–Ω–æ) ‚Äî ‚úÖ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

–¶–µ–ª—å: —Å–¥–µ–ª–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ Telegram –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–º –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –ø–æ –¥–∞–Ω–Ω—ã–º. –¢–µ–ø–µ—Ä—å TelegramErrorHandler –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ñ–æ–Ω–æ–≤–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–∞ –∏ –æ—á–µ—Ä–µ–¥—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∞–π–º-–∞—É—Ç—ã httpx, –≤–≤–æ–¥–∏—Ç rate-limit –∏ –º–∞—Å–∫–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω—ã/—Å–µ–∫—Ä–µ—Ç—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π. –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Telegram –æ—à–∏–±–∫–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç event-loop –∏ –ø–∏—à—É—Ç—Å—è –≤ stdout –∫–∞–∫ —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è. –£—Ä–æ–≤–µ–Ω—å –∞–ª–µ—Ä—Ç–æ–≤ –º–æ–∂–Ω–æ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä level –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.

‚∏ª

A4. –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) ‚Äî ‚úÖ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

–¶–µ–ª—å: –Ω–∞–¥—ë–∂–Ω–∞—è –æ—á–µ—Ä–µ–¥—å —Ç—è–∂—ë–ª—ã—Ö –∑–∞–¥–∞—á (–æ—Ç—á—ë—Ç—ã, GPT, OpenAI), —Å –≤–æ—Ä–∫–µ—Ä–∞–º–∏, —Ä–µ—Ç—Ä–∞—è–º–∏ –∏ ID –∑–∞–¥–∞—á. –í `bot.py` –æ—á–µ—Ä–µ–¥—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –ø–æ —Ä–∞–∑–º–µ—Ä—É, –∑–∞–¥–∞—á–∏ –ø–æ–ª—É—á–∞—é—Ç `task_id`, –∞ `add_task` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏ —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å. –°–æ—Å—Ç–æ—è–Ω–∏—è —Å–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –≤ `task_registry` –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `get_task_status`, —á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥–∞ `/task_status` –º–æ–≥–ª–∞ –∑–∞–±–∏—Ä–∞—Ç—å –∏—Ö –∏–∑ –ø–∞–º—è—Ç–∏. –í–æ—Ä–∫–µ—Ä—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ (`start_workers`) –∏ —É–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∞—Ç—å—Å—è (`stop_workers`). –°–∞–º –≤–æ—Ä–∫–µ—Ä —Å–ª–µ–¥–∏—Ç –∑–∞ –ø–æ–ø—ã—Ç–∫–∞–º–∏, –ø—Ä–∏–º–µ–Ω—è–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backoff —Å –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü–µ–π, –ø–æ–≤—Ç–æ—Ä–Ω–æ —Å—Ç–∞–≤–∏—Ç –∑–∞–¥–∞—á—É —á–µ—Ä–µ–∑ —Ñ–æ–Ω–æ–≤—ã–π scheduler –∏ –ª–æ–≥–∏—Ä—É–µ—Ç –∫–∞–∂–¥—É—é –æ—à–∏–±–∫—É. –ü—Ä–∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `QueueFullError` —Å –ø–æ–Ω—è—Ç–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é; —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —á–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è —Ä–µ—Ç—Ä–∞–µ–≤.

‚∏ª

A5. –£–¥–∞–ª–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç matplotlib (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) ‚Äî ‚úÖ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

–¶–µ–ª—å: —É–±—Ä–∞—Ç—å –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ —Ç—è–∂—ë–ª—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

–°–¥–µ–ª–∞–Ω–æ:
	‚Ä¢	–í—ã—Ä–µ–∑–∞–Ω –∫–æ–¥ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤ bot.py, progress_data.py, visualization.py.
	‚Ä¢	–£–¥–∞–ª–µ–Ω—ã –∏–∑ requirements.txt matplotlib, seaborn, scipy –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (temp_plots, visualization.log).

–û—Å—Ç–∞–ª–æ—Å—å:
	‚Ä¢	–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤–Ω—É—Ç—Ä–∏ bot.py –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—ë–Ω –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä –∏ callback-–º–µ–Ω—é –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ (—Å–º. A5.1).

A5.1. –ü–æ–ª–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤ bot.py ‚Äî ‚úÖ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å)
	1.	–£–¥–∞–ª–µ–Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π:
	‚Ä¢	–∫–ª–∞—Å—Å—ã DataProcessor, MetricProcessor;
	‚Ä¢	—Ç–∏–ø—ã MetricConfig/VisualizationConfig/TrendData;
	‚Ä¢	—Å–ª–æ–≤–∞—Ä–∏ PLOT_CONFIGS, VALIDATION_RULES;
	‚Ä¢	—Ñ—É–Ω–∫—Ü–∏–∏ _prepare_data_for_visualization, _create_visualization, _process_metric_data, _calculate_trends, _get_visualization_config, fetch_operator_progress_data;
	‚Ä¢	VISUALIZATION_DISABLED_MESSAGE ‚Äî –ª–∏–±–æ —É–¥–∞–ª—ë–Ω, –ª–∏–±–æ –æ—Å—Ç–∞–≤–ª–µ–Ω –∫–∞–∫ –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–π.
	2.	–ü–µ—Ä–µ–ø–∏—Å–∞–Ω—ã/—É–¥–∞–ª–µ–Ω—ã –∫–æ–º–∞–Ω–¥—ã –∏ callback-–∏:
	‚Ä¢	/operator_progress, /all_operators_progress, /operator_progress_menu;
	‚Ä¢	callback-–∏ –ø–æ period, graph, metric, filter, page.
	3.	–û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
	‚Ä¢	—É–¥–∞–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã pandas, numpy, BytesIO –∏ –ø—Ä–æ—á–µ–µ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–µ–µ—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤.
	4.	–û–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
	‚Ä¢	–≤–º–µ—Å—Ç–æ –∑–∞–≥–ª—É—à–µ–∫ ‚Äú–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞‚Äù ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º –æ—Ç—á—ë—Ç–æ–≤.
	5.	–î–æ–±–∞–≤–ª–µ–Ω sanity-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç:
	‚Ä¢	–Ω–∏–∫–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã/–∫–æ–ª–±—ç–∫–∏ –Ω–µ —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ —Å—Ç–∞—Ä—ã–µ –º–µ—Ç–æ–¥—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.

‚∏ª

A6. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –≤ —è–¥—Ä–µ (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) ‚Äî üöß —á–∞—Å—Ç–∏—á–Ω–æ –≥–æ—Ç–æ–≤–æ

–¶–µ–ª—å: —É–±—Ä–∞—Ç—å –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ª–æ–º–∞—é—Ç —Å–µ—Ä–≤–∏—Å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å.

–ó–∞–¥–∞—á–∏:
	1.	–ü–æ—á–∏–Ω–∏—Ç—å SQL-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ operator_data.py:292-299 ‚Äî ‚úÖ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (–ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –∏ —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ).
	2.	–í metrics_calculator.py:12-20 ‚Äî ‚úÖ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (–ª–æ–≥–≥–µ—Ä –∏ –º–µ—Ç–æ–¥ calculate_avg_duration –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã).
	‚Ä¢	–ª–æ–≥–≥–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ self.logger (–±–µ–∑ –ø–∞–¥–µ–Ω–∏—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ);
	‚Ä¢	`calculate_avg_duration` —Å—Ç–∞–ª –º–µ—Ç–æ–¥–æ–º –∫–ª–∞—Å—Å–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `self`.
	3.	–£–¥–∞–ª–∏—Ç—å –∑–∞–ø—É—Å–∫ aiohttp/Sentry –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ openai_tele–±–æ—Ç.py ‚Äî ‚úÖ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: –∏–º–ø–æ—Ä—Ç –±–æ–ª—å—à–µ –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç web.run_app, –æ—Å—Ç–∞–≤–ª–µ–Ω –ª–∏—à—å –≤—ã–∑–æ–≤ setup_global_error_handler.
	‚Ä¢	–Ω–µ —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å HTTP-—Å–µ—Ä–≤–µ—Ä –∏ Sentry –≤ import;
	‚Ä¢	–≤—ã–Ω–µ—Å—Ç–∏ –∑–∞–ø—É—Å–∫ web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –±–ª–æ–∫ if __name__ == "__main__": –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, –µ—Å–ª–∏ –≤–æ–æ–±—â–µ –Ω—É–∂–Ω–æ.
	4.	–û—á–∏—Å—Ç–∏—Ç—å bot.py ‚Äî ‚úÖ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:
	‚Ä¢	—É–±—Ä–∞–Ω—ã –¥–µ—Å—è—Ç–∫–∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç, –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–∫–µ–Ω–∞ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ config;
	‚Ä¢	—É–¥–∞–ª–µ–Ω—ã —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ HELP/ split_text –∑–∞–≥–ª—É—à–∫–∏ –∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π CallbackDispatcher.

–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–∑ –∫–æ–¥-—Ä–µ–≤—å—é (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏):
	1.	–¢–æ–∫–µ–Ω Telegram ‚Äî –∑–∞—Ç–∏—Ä–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–π "YOUR_BOT_TOKEN". ‚Äî ‚úÖ —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ (—Ç–æ–∫–µ–Ω –±–µ—Ä—ë—Ç—Å—è –∏–∑ config, –Ω–µ –ø–µ—á–∞—Ç–∞–µ—Ç—Å—è –∏ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è).
	2.	–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—É–ª–∞ –ë–î ‚Äî create_pool –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–æ acquire. ‚Äî ‚úÖ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: acquire —Ç–µ–ø–µ—Ä—å –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç create_pool, —á—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç RuntimeError.
	3.	–°–ª–æ–º–∞–Ω–Ω—ã–π SQL –≤ operator_data.py:292-299. ‚Äî ‚úÖ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ.
	4.	–õ–æ–≥–≥–µ—Ä –≤ MetricsCalculator –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ. ‚Äî ‚úÖ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ.
	5.	–ó–∞–ø—É—Å–∫ aiohttp –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ openai_telebot.py. ‚Äî ‚úÖ —É–±—Ä–∞–Ω–æ.
	6.	–û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á —Ç–µ—Ä—è–µ—Ç –∑–∞–¥–∞—á–∏ –ø—Ä–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è—Ö. ‚Äî ‚úÖ —Ä–µ—à–µ–Ω–æ –≤ A4 (bounded queue —Å —Ä–µ—Ç—Ä–∞—è–º–∏).
	7.	–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π TelegramErrorHandler –±–ª–æ–∫–∏—Ä—É–µ—Ç event-loop. ‚Äî ‚úÖ —Ä–µ—à–µ–Ω–æ –≤ A3 (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å + —Ç–∞–π–º-–∞—É—Ç—ã).

A6.1. –†–∞–∑–¥—Ä–æ–±–∏—Ç—å bot.py –Ω–∞ –º–æ–¥—É–ª–∏ (—á–∞—Å—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)
	1.	–°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:
	‚Ä¢	–≤—ã–¥–µ–ª–∏—Ç—å –¥–æ–º–µ–Ω—ã: –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è/permissions, –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á, Telegram-–∫–æ–º–∞–Ω–¥—ã, callback-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, OpenAI –æ—Ç—á—ë—Ç—ã, —Ä–∞–±–æ—Ç–∞ —Å –ë–î.
	‚Ä¢	—Å–æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞—Ä—Ç—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É —ç—Ç–∏–º–∏ —á–∞—Å—Ç—è–º–∏.
	2.	–í—ã–¥–µ–ª–∏—Ç—å –ø–∞–∫–µ—Ç—ã:
	‚Ä¢	bot/commands, bot/handlers, bot/services, bot/utils.
	‚Ä¢	–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏:
	‚Ä¢	–∫–æ–º–∞–Ω–¥–Ω—ã–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã (/start, /help, /report_summary, –∏ –¥—Ä.);
	‚Ä¢	CallbackDispatcher –∏ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏;
	‚Ä¢	—Å–µ—Ä–≤–∏—Å—ã (OpenAI-–æ—Ç—á—ë—Ç—ã, –æ—á–µ—Ä–µ–¥–∏, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —Ä–∞–±–æ—Ç–∞ —Å –ë–î —á–µ—Ä–µ–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏);
	‚Ä¢	–≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã, –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã, –ø–æ–º–æ—â–Ω–∏–∫–∏ ‚Äî –≤ utils.
	3.	–û—á–∏—Å—Ç–∫–∞ –∏ —É–ø—Ä–æ—â–µ–Ω–∏–µ:
	‚Ä¢	—É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–π—Å—è –∫–æ–¥ –∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∑–∞–≥–ª—É—à–∫–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π).
	‚Ä¢	–≤—ã–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (PERIOD_CONFIG, CALLBACK_TYPES –∏ —Ç.–ø.) –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏.
	‚Ä¢	–≤–Ω–µ–¥—Ä–∏—Ç—å DI: TelegramBot –ø–æ–ª—É—á–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã/—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏–∑–≤–Ω–µ.
	4.	–û–±–Ω–æ–≤–∏—Ç—å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞:
	‚Ä¢	main/–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ —Å–æ–±–∏—Ä–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π.
	5.	–û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
	‚Ä¢	–æ–ø–∏—Å–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑–±–∏–µ–Ω–∏—è –≤ README.

‚∏ª

A7. –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

–¶–µ–ª—å: –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —Å–ª–æ–º–∞ root-–ª–æ–≥–≥–µ—Ä–∞ –∏ –±–µ–∑ —à—É–º–∞.

A7.WDOG. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å WATCH_DOG ‚Äî "–æ–≤—á–∞—Ä–∫—É" –¥–ª—è –≤—Å–µ—Ö –ª–æ–≥–æ–≤

–¶–µ–ª—å: –≤—Å–µ –ª–æ–≥–∏ –ø—Ä–æ–µ–∫—Ç–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ WATCH_DOG. "–û–≤—á–∞—Ä–∫–∞" –Ω—é—Ö–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –º–∞—Å–∫–∏—Ä—É–µ—Ç —Å–µ–∫—Ä–µ—Ç—ã, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —à—É–º –∏ —Ä–∞—Å—Å—ã–ª–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ –Ω—É–∂–Ω—ã–µ –∫–∞–Ω–∞–ª—ã (—Ñ–∞–π–ª, –∫–æ–Ω—Å–æ–ª—å, Telegram, Sentry). –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ logging.getLogger –≤ –∫–æ–¥–µ –∑–∞–ø—Ä–µ—â—ë–Ω ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ API WATCH_DOG.

–ó–∞–¥–∞—á–∏:
	1. –°–æ–∑–¥–∞—Ç—å –ø–∞–∫–µ—Ç `watch_dog` —Å —è–¥—Ä–æ–º (WatchDogLogger, WatchDogHandler, WatchDogAlert, WatchDogConfig).
	2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω–æ–µ API: `from watch_dog import get_watchdog_logger`, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä –∏ –æ—á–µ—Ä–µ–¥—å –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤.
	3. –î–æ–±–∞–≤–∏—Ç—å –æ—á–µ—Ä–µ–¥–∏ –∏ rate-limit: WATCH_DOG –±—É—Ñ–µ—Ä–∏–∑—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É –≤ Telegram/Sentry, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç backoff –∏ self-test.
	4. –ú–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å PII –∏ —Ç–æ–∫–µ–Ω—ã, –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π (–æ–≤—á–∞—Ä–∫–∞ –≤—ã—á–∏—â–∞–µ—Ç –≤—Å—ë –ª–∏—à–Ω–µ–µ).
	5. –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤—Å–µ –º–æ–¥—É–ª–∏ (bot.py, openai_telebot.py, auth.py, db_module.py, notifications_manager.py –∏ —Ç.–¥.) –Ω–∞ WATCH_DOG; —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ setup_logging.
	6. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ (yaml/env) —Å —É—Ä–æ–≤–Ω—è–º–∏, –∫–∞–Ω–∞–ª–∞–º–∏, —Ñ–∏–ª—å—Ç—Ä–∞–º–∏; –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª/–∞–ª–µ—Ä—Ç.
	7. –í README –æ–ø–∏—Å–∞—Ç—å, —á—Ç–æ WATCH_DOG ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ—Ö—Ä–∞–Ω–∞ –ª–æ–≥–æ–≤, –±–µ–∑ –Ω–µ–≥–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ª–æ–≥–∏—Ä—É–µ–º.


A7.1. –í–Ω–µ–¥—Ä–∏—Ç—å WATCH_DOG ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–¶–µ–ª—å:

A7.2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –≤—ã—Ä–æ–≤–Ω—è—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö

–¶–µ–ª—å: –ø—Ä–∏–≤–µ—Å—Ç–∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (SQL-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, DTO, –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π) –∫ –µ–¥–∏–Ω–æ–º—É –≤–∏–¥—É, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Å–∫—Ä—ã—Ç—ã—Ö –æ—à–∏–±–æ–∫.

–ó–∞–¥–∞—á–∏:
	1. –°–æ—Å—Ç–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π, –≥–¥–µ —Ç–∏–ø—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç (operator_data.py, metrics_calculator.py, openai_telebot.py, db_module.py –∏ —Ç.–¥.).
	2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SQL-–∑–∞–ø—Ä–æ—Å—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–ª–æ–≤–∞—Ä–∏/—Å–ø–∏—Å–∫–∏ –≤ operator_data –∏ MetricsCalculator –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ TypedDict/Protocol/–¥–∞—Ç–∞-–∫–ª–∞—Å—Å—ã.
	3. –î–æ–±–∞–≤–∏—Ç—å/—É—Ç–æ—á–Ω–∏—Ç—å type hints (–Ω–∞–ø—Ä–∏–º–µ—Ä, Optional[List[Dict[str, Any]]], TypedDict –¥–ª—è call_scores, –æ—Ç—á—ë—Ç–æ–≤, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π).
	4. –û–±–Ω–æ–≤–∏—Ç—å DTO/TypedDict –¥–ª—è API (openai_telebot, notifications_manager, tasks).
	5. –í–∫–ª—é—á–∏—Ç—å mypy/pyright –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –≤ CI.
	6. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ —Ç–∏–ø–∞–º (README/DEV_NOTES).
	7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤/–º–µ—Ç—Ä–∏–∫ –Ω–µ –ø–∞–¥–∞–µ—Ç –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, str vs float).
 –≤—Å—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–æ–≤ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –º–æ–¥—É–ª—å "–æ–≤—á–∞—Ä–∫–∏", –∫–æ—Ç–æ—Ä—ã–π
–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–±–æ—Ä, —Ä–æ—Ç–∞—Ü–∏—é, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é, –∞–ª–µ—Ä—Ç—ã –∏ –≤–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

–ó–∞–¥–∞—á–∏:
	1. –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å `watch_dog` —Å –∫–ª–∞—Å—Å–∞–º–∏ –ª–æ–≥–≥–µ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, WatchDogLogger, WatchDogHandler, WatchDogAlert).
	2. –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –ø—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `logging.getLogger` –∏ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤–æ –≤—Å—ë–º –ø—Ä–æ–µ–∫—Ç–µ ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `watch_dog`.
	3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏:
		‚Ä¢ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ –ª–æ–≥–≥–µ—Ä–∞ (root) + –¥–æ—á–µ—Ä–Ω–∏—Ö –ª–æ–≥–≥–µ—Ä–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤;
		‚Ä¢ —Ä–æ—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤, –∫–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª –∏ stdout;
		‚Ä¢ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (Telegram/Sentry) ‚Äî —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å, —Å backoff –∏ rate-limit;
		‚Ä¢ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è PII, –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤;
		‚Ä¢ health-check –∏ self-test "–æ–≤—á–∞—Ä–∫–∏".
	4. –î–æ–±–∞–≤–∏—Ç—å watchdog-config (yaml/json) with —É—Ä–æ–≤–Ω—è–º–∏, –∫–∞–Ω–∞–ª–∞–º–∏, –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ–º.
	5. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –º–æ–¥—É–ª–∏ (bot.py, openai_telebot.py, db_module.py, auth.py –∏ –¥—Ä.), –ø–æ–¥–∫–ª—é—á–∞—è —Ç–æ–ª—å–∫–æ `watch_dog`.
	6. –ü—Ä–æ–ø–∏—Å–∞—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: WATCH_DOG –Ω—é—Ö–∞–µ—Ç –≤—Å–µ –ª–æ–≥–∏, –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç, –ø–æ–¥–Ω–∏–º–∞–µ—Ç –∞–ª–µ—Ä—Ç—ã.
	7. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (README) ‚Äî –∫–∞–∫ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –ª–æ–≥–∞–º, –∫–∞–∫ –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã.


–ó–∞–¥–∞—á–∏:
	1.	–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–¥–∏–Ω—ã–π –º–æ–¥—É–ª—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
	‚Ä¢	–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å logging.config.dictConfig;
	‚Ä¢	–Ω–µ –æ—á–∏—â–∞—Ç—å root-handlers.
	2.	–†–∞–∑–≤–µ—Å—Ç–∏ —É—Ä–æ–≤–Ω–∏ dev/prod:
	‚Ä¢	dev ‚Äî –ø–æ–¥—Ä–æ–±–Ω—ã–µ DEBUG/INFO;
	‚Ä¢	prod ‚Äî INFO/ERROR, –±–µ–∑ —Å–ø–∞–º–∞ –ø–æ –∫–∞–∂–¥–æ–π –º–µ—Ç—Ä–∏–∫–µ.
	3.	–ò—Å–∫–ª—é—á–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ –ª–æ–≥–æ–≤ (—Å–º. –±–ª–æ–∫ A1).
	4.	–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (logs/).
	5.	–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –æ—Å–æ–±–æ —à—É–º–Ω—ã–µ –ª–æ–≥–∏ (metrics_calculator, –∏ —Ç.–ø.) –Ω–∞ DEBUG.

–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–∑ –∫–æ–¥-—Ä–µ–≤—å—é:
	‚Ä¢	logger_utils.setup_logging –æ—á–∏—â–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ root-–ª–æ–≥–≥–µ—Ä–∞.
	‚Ä¢	–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–æ–¥–∏–ª–∞ —Å–≤–æ–π —Ñ–∞–π–ª–æ–≤—ã–π –ª–æ–≥–≥–µ—Ä –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ.
	‚Ä¢	–õ–æ–≥–∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω—ã —à—É–º–æ–º, —Ñ–∞–π–ª—ã –¥–æ—Å—Ç–∏–≥–∞—é—Ç —Å–æ—Ç–µ–Ω –ú–ë.
	‚Ä¢	–ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —á–∞—Å—Ç–æ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—à–∏–±–æ–∫ –≤ Telegram.

‚∏ª

A8. –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

–¶–µ–ª—å: —Å–Ω—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–¥–µ.

–ó–∞–¥–∞—á–∏:
	1.	–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ pytest:
	‚Ä¢	—Ñ–∏–∫—Å—Ç—É—Ä—ã: –º–æ–∫ –ë–î, –º–æ–∫ Telegram API, –º–æ–∫ –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á.
	2.	Unit-—Ç–µ—Å—Ç—ã:
	‚Ä¢	–ø–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç;
	‚Ä¢	—Ä–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫ –≤ MetricsCalculator;
	‚Ä¢	permissions_manager (—Ä–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å –¥–æ—Å—Ç—É–ø–∞).
	3.	–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:
	‚Ä¢	–æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á (–ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, —Ä–µ—Ç—Ä–∞–∏);
	‚Ä¢	–±–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã Telegram (—Å –º–æ–∫–∞–º–∏).
	4.	E2E smoke-—Ç–µ—Å—Ç:
	‚Ä¢	–ø–æ–¥–Ω—è—Ç—å –±–æ—Ç–∞ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ;
	‚Ä¢	–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ü–µ–ø–æ—á–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç.
	5.	CI:
	‚Ä¢	–ø–æ–¥–∫–ª—é—á–∏—Ç—å GitHub Actions (–∏–ª–∏ –¥—Ä—É–≥–æ–π CI);
	‚Ä¢	–∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –∫–∞–∂–¥—ã–π Pull Request.

–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–∑ –∫–æ–¥-—Ä–µ–≤—å—é:
	‚Ä¢	tests/ –ø–æ—á—Ç–∏ –ø—É—Å—Ç;
	‚Ä¢	–Ω–µ—Ç –º–æ–∫–æ–≤ –ë–î –∏ Telegram API;
	‚Ä¢	–Ω–µ—Ç e2e-—Ç–µ—Å—Ç–æ–≤.

‚∏ª

A9. –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

–¶–µ–ª—å: —É–±—Ä–∞—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∏ –º—É—Å–æ—Ä –∏–∑ Git, –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ–¥.

–ó–∞–¥–∞—á–∏:
	1.	–£–¥–∞–ª–∏—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
	‚Ä¢	logs.log
	‚Ä¢	dump.rdb
	‚Ä¢	temp_plots
	‚Ä¢	visualization.log
	‚Ä¢	–ø—Ä–æ—á–∏–µ runtime-—Ñ–∞–π–ª—ã.
	2.	–û–±–Ω–æ–≤–∏—Ç—å .gitignore:
	‚Ä¢	–¥–æ–±–∞–≤–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é logs/, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏, .env, –¥–∞–º–ø—ã, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã IDE.
	3.	–û–±–Ω–æ–≤–∏—Ç—å README:
	‚Ä¢	–æ–ø–∏—Å–∞—Ç—å, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–º–ø—ã/–ª–æ–≥–∏.
	4.	–ù–∞—Å—Ç—Ä–æ–∏—Ç—å pre-commit/—Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:
	‚Ä¢	–∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ–ø–∞–¥–∞—Ç—å –≤ –∫–æ–º–º–∏—Ç.

–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–∑ –∫–æ–¥-—Ä–µ–≤—å—é:
	‚Ä¢	–õ–æ–≥–∏ –∏ –¥–∞–º–ø—ã –ø—Ä—è–º–æ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

‚∏ª

–ë–õ–û–ö B. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏ –¥–ª—è —Å—Ç–∞—Ä—à–∏—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

B1. –ö–æ–º–∞–Ω–¥–∞ /call_lookup (–Ω–∏–∑–∫–∏–π, –Ω–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ –≤–∞–∂–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) ‚Äî üöß —á–∞—Å—Ç–∏—á–Ω–æ –≥–æ—Ç–æ–≤–æ

–¶–µ–ª—å: –±—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–≤–æ–Ω–∫–æ–≤ –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–æ–∫ –ø–æ –Ω–æ–º–µ—Ä—É –ø–∞—Ü–∏–µ–Ω—Ç–∞.

–ó–∞–¥–∞—á–∏:
	1.	–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å CallLookupService ‚Äî ‚úÖ –≥–æ—Ç–æ–≤–æ (call_lookup_service.py):
	‚Ä¢	–ø–æ–∏—Å–∫ –ø–æ call_history / call_scores –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ + –ø–µ—Ä–∏–æ–¥ (LIMIT/OFFSET, –ø–µ—Ä–∏–æ–¥ –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ DatabaseManager.parse_period);
	‚Ä¢	–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–æ —Ü–∏—Ñ—Ä (—É–¥–∞–ª–µ–Ω–∏–µ +, –ø—Ä–æ–±–µ–ª–æ–≤, (), -, –ø–µ—Ä–µ–≤–æ–¥ 8‚Üí7);
	‚Ä¢	–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ DTO –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ (history_id, call_time, –∑–∞–ø–∏—Å—å, transcript, score).
	2.	–í–≤–µ—Å—Ç–∏ —Ç–∞–±–ª–∏—Ü—É call_access_logs:
	‚Ä¢	–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤—ã–¥–∞—á —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–æ–∫ (–∫—Ç–æ, –∫–æ–≥–¥–∞, –ø–æ –∫–∞–∫–æ–º—É –Ω–æ–º–µ—Ä—É) ‚Äî ‚úÖ —Å–µ—Ä–≤–∏—Å –ø–∏—à–µ—Ç INSERT –≤ call_access_logs c graceful degradation.
	3.	–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É /call_lookup <phone> [period] ‚Äî ‚úÖ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –º–æ–¥—É–ª—å `call_lookup_handlers.py`:
	‚Ä¢	–≤—ã–¥–∞—á–∞ —Å–ø–∏—Å–∫–∞: –¥–∞—Ç–∞/–≤—Ä–µ–º—è | –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | ID –∑–∞–ø–∏—Å–∏ + –æ—Ü–µ–Ω–∫–∞/–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å;
	‚Ä¢	–ø–∞–≥–∏–Ω–∞—Ü–∏—è (–∫–Ω–æ–ø–∫–∏ ¬´–ù–∞–∑–∞–¥/–î–∞–ª–µ–µ¬ª, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ offset).
	4.	–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å inline-–∫–Ω–æ–ø–∫–∏ ‚Äî ‚úÖ –≤ `register_call_lookup_handlers`:
	‚Ä¢	¬´–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞¬ª / ¬´–ó–∞–ø–∏—Å—å¬ª –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞;
	‚Ä¢	–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∞—É–¥–∏–æ ‚Äî –∫–Ω–æ–ø–∫–∞ ¬´–ó–∞–ø–∏—Å—å¬ª.
	5.	–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø ‚Äî ‚úÖ –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å —á–µ—Ä–µ–∑ PermissionsManager.check_permission —Å –ø—Ä–∞–≤–æ–º `call_lookup`.
	6.	–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –∫–æ–º–∞–Ω–¥–µ –∏ –≤—ã–¥–∞—á–∏ ‚Äî ‚úÖ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ CallLookupService._log_access.

–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–∑ –±–ª–æ–∫–æ–≤ 13.1 –∏ 10:
	‚Ä¢	–°—Ç–∞—Ä—à–∏–π –∞–¥–º–∏–Ω –≤–≤–æ–¥–∏—Ç –Ω–æ–º–µ—Ä, –±–æ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –Ω–æ–º–µ—Ä.
	‚Ä¢	–ó–∞–ø—Ä–æ—Å –ø–æ call_history/call_scores —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≤—ã–¥–∞—á–∏ (5 –∑–∞–ø–∏—Å–µ–π, –ø–∞–≥–∏–Ω–∞—Ü–∏—è) ‚Äî CallLookupService.lookup_calls –¥–µ–ª–∞–µ—Ç –≤—ã–±–æ—Ä–∫—É.
	‚Ä¢	–ü–æ –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–æ–π –∏ —Å—Å—ã–ª–∫–æ–π –Ω–∞ –∑–∞–ø–∏—Å—å (fetch_call_details –≥–æ—Ç–æ–≤, –æ—Å—Ç–∞–ª–æ—Å—å —Å–≤—è–∑–∞—Ç—å —Å –∫–æ–º–∞–Ω–¥–æ–π/inline-–∫–Ω–æ–ø–∫–∞–º–∏).

‚∏ª

B2. –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –∫–∞—á–µ—Å—Ç–≤–∞ /weekly_quality (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

–¶–µ–ª—å: —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –±–µ–∑ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–æ–∫.

–ó–∞–¥–∞—á–∏:
	1.	–î–æ–±–∞–≤–∏—Ç—å –≤ MetricsCalculator –º–µ—Ç–æ–¥ calculate_weekly_quality_overview(period) /
	calculate_quality_summary(start_date, end_date) ‚Äî ‚úÖ `calculate_quality_summary` —Å—á–∏—Ç–∞–µ—Ç –≤—Å–µ –∞–≥—Ä–µ–≥–∞—Ç—ã:
		‚Ä¢	—Å—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞, –¥–æ–ª—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö,
		‚Ä¢	–∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –∑–∞–ø–∏—Å—å,
		‚Ä¢	–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏–¥–æ–≤,
		‚Ä¢	–æ—Ç–º–µ–Ω—ã.
	2.	–ù–∞—Å—Ç—Ä–æ–∏—Ç—å APScheduler:
	‚Ä¢	–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ 09:00);
	‚Ä¢	—Ä–∞—Å—Å—ã–ª–∫–∞ –æ—Ç—á—ë—Ç–∞ —Å—Ç–∞—Ä—à–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º.
	3.	–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É /weekly_quality [period]:
	‚Ä¢	—Ä—É—á–Ω–æ–π –∑–∞–ø—Ä–æ—Å —Ç–æ–≥–æ –∂–µ –æ—Ç—á—ë—Ç–∞ –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –ø—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è).
	4.	–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ —Ä–æ–ª—è–º (—Å—Ç–∞—Ä—à–∏–µ –∞–¥–º–∏–Ω—ã).
	5.	–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
	‚Ä¢	—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î;
	‚Ä¢	–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TTL/–ø–µ—Ä–∏–æ–¥, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –ë–î –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.
	6.	–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç—á—ë—Ç–æ–≤.

–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–∑ –±–ª–æ–∫–æ–≤ 13.2 –∏ 11:
	‚Ä¢	–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (apscheduler) –∑–∞–ø—É—Å–∫–∞–µ—Ç –∑–∞–¥–∞—á—É —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é.
	‚Ä¢	–†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç + –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ CSV.
	‚Ä¢	–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MetricsCalculator –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∞–≥—Ä–µ–≥–∞—Ü–∏–π.

‚∏ª

–ë–õ–û–ö C. –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)

–¶–µ–ª—å: —É–π—Ç–∏ –æ—Ç –º–æ–Ω–æ–ª–∏—Ç–∞ bot.py –∏ –∑–æ–æ–ø–∞—Ä–∫–∞ –º–æ–¥—É–ª–µ–π –∫ —á—ë—Ç–∫–æ–π —Å–ª–æ—ë–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ.

C1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ (—Ü–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)

operabot/
  app/
    main.py                # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
    config.py              # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è/—Å–µ–∫—Ä–µ—Ç—ã
    logging_config.py      # –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–æ–≤

    db/
      manager.py           # –µ–¥–∏–Ω—ã–π DatabaseManager
      models.py            # dataclass/DTO –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤, –∑–≤–æ–Ω–∫–æ–≤, –º–µ—Ç—Ä–∏–∫
      repositories/
        operators_repo.py  # —Ä–∞–±–æ—Ç–∞ —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ –∏ –∑–≤–æ–Ω–∫–∞–º–∏
        metrics_repo.py    # –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã

    telegram/
      bot.py               # –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ö–µ–Ω–¥–ª–µ—Ä–æ–≤
      handlers/
        core.py            # /start, /help, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
        call_lookup.py     # /call_lookup
        weekly_quality.py  # /weekly_quality
      middlewares/
        auth.py            # –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π/–ø—Ä–∞–≤ (PermissionsManager)
        logging.py         # –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

    services/
      metrics.py           # MetricsCalculator, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –º–µ—Ç—Ä–∏–∫
      calls.py             # –ø–æ–∏—Å–∫ –∑–≤–æ–Ω–∫–æ–≤, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
      reports.py           # –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ—Ç—á—ë—Ç–æ–≤
      permissions.py       # —Ä–æ–ª–∏/–ø—Ä–∞–≤–∞

    workers/
      queue.py             # –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á, –≤–æ—Ä–∫–µ—Ä—ã –¥–ª—è —Ç—è–∂—ë–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
      tasks.py             # –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞ –∏ —Ç.–ø.)

  tests/
    unit/
    integration/
    e2e/

  requirements.txt
  .env.example
  .gitignore
  README.md

C2. –ó–∞–¥–∞—á–∏ –ø–æ –ø–µ—Ä–µ—Ö–æ–¥—É –∫ —ç—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
	1.	–°–æ–∑–¥–∞—Ç—å –∫–∞—Ä–∫–∞—Å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (–±–µ–∑ –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏).
	2.	–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å:
	‚Ä¢	—Ä–∞–±–æ—Ç—É —Å –ë–î ‚Üí db/manager.py + repositories/;
	‚Ä¢	–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É ‚Üí services/ (metrics, calls, reports, permissions);
	‚Ä¢	Telegram-—Ö–µ–Ω–¥–ª–µ—Ä—ã ‚Üí telegram/handlers;
	‚Ä¢	middlewares ‚Üí telegram/middlewares;
	‚Ä¢	–æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á ‚Üí workers/.
	3.	–û–±–Ω–æ–≤–∏—Ç—å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞:
	‚Ä¢	app/main.py –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å:
	‚Ä¢	–Ω–∞—Å—Ç—Ä–æ–π–∫—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è;
	‚Ä¢	–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é DatabaseManager –∏ –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á;
	‚Ä¢	—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∏ –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞.
	4.	–í—ã—Ä–æ–≤–Ω—è—Ç—å DI:
	‚Ä¢	TelegramBot –ø–æ–ª—É—á–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã/—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ.
	5.	–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ ¬´–ø–ª–æ—Å–∫–∏–µ¬ª —Ñ–∞–π–ª—ã –ø–æ –º–µ—Ä–µ –ø–µ—Ä–µ–Ω–æ—Å–∞ (–ø–æ—Å–ª–µ –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏).

–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–∑ –∫–æ–¥-—Ä–µ–≤—å—é:
	‚Ä¢	–°–µ–π—á–∞—Å –≤—Å—ë —Å–º–µ—à–∞–Ω–æ –≤ bot.py, openai_telebot.py, metrics_calculator.py, operator_data.py, progress_data.py.
	‚Ä¢	–ú–æ–¥—É–ª–∏ —Å–∞–º–∏ —Ç—è–Ω—É—Ç –æ–∫—Ä—É–∂–µ–Ω–∏–µ, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∑–∞–ø—É—Å–∫–∞—é—Ç —Ñ–æ–Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, —á—Ç–æ –ª–æ–º–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å.

‚∏ª

–ë–õ–û–ö D. ML-–º–æ–¥—É–ª—å –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤ (–æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–¥–ø—Ä–æ–µ–∫—Ç –ø–æ–≤–µ—Ä—Ö Operabot)

–°—é–¥–∞ –≤—ã–¥–µ–ª–µ–Ω –≤–µ—Å—å —Ç–≤–æ–π ML-–±–ª–æ–∫: –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, time-series, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å n8n –∏ GPT.

D1. –¶–µ–ª–∏ ML-–º–æ–¥—É–ª—è (—Ñ–∏–∫—Å–∏—Ä—É–µ–º –∫–∞–∫ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–¥–∞—á–∏)

–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ ML:
	1.	–ü—Ä–æ–≥–Ω–æ–∑ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:
	‚Ä¢	–ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –∏—Å—Ö–æ–¥ –∑–≤–æ–Ω–∫–∞ (record / lead_no_record / info_only);
	‚Ä¢	–ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–∫–∞–∑–∞/—Å—Ä—ã–≤–∞ –≤–∏–∑–∏—Ç–∞;
	‚Ä¢	–ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å non_target (–º—É—Å–æ—Ä–Ω—ã–µ –∑–≤–æ–Ω–∫–∏).
	2.	–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤:
	‚Ä¢	–Ω–∞–π—Ç–∏ —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞ –∫–∞–∂–¥–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞;
	‚Ä¢	–≤—ã—è–≤–ª—è—Ç—å ¬´—É—Å—Ç–∞–ª–æ—Å—Ç—å¬ª, –ø–∞–¥–µ–Ω–∏–µ —Ç–æ–Ω–∞.
	3.	–ù–∞–≥—Ä—É–∑–∫–∞ –∫–æ–ª–ª-—Ü–µ–Ω—Ç—Ä–∞:
	‚Ä¢	–ø—Ä–æ–≥–Ω–æ–∑ –ø–æ —á–∞—Å–∞–º/–¥–Ω—è–º: —Å–∫–æ–ª—å–∫–æ –∑–≤–æ–Ω–∫–æ–≤, —Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –Ω—É–∂–Ω–æ.
	4.	–¢–µ–º–∞—Ç–∏–∫–∞ –∏ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å:
	‚Ä¢	–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è/—Ç–æ–ø–∏–∫-–º–æ–¥–µ–ª–∏–Ω–≥ —Ç–µ–º –∑–≤–æ–Ω–∫–æ–≤;
	‚Ä¢	–¥–µ—Ç–µ–∫—Ç —Ç–æ–∫—Å–∏—á–Ω—ã—Ö/–∫–æ–Ω—Ñ–ª–∏–∫—Ç–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤.
	5.	–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑:
	‚Ä¢	—Å–≤—è–∑–∫–∞ –∑–≤–æ–Ω–∫–æ–≤ —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –ª–∏–¥–æ–≤.

–ü—Ä–∏–Ω—Ü–∏–ø:
	‚Ä¢	ML = –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ/–ø–∞—Ç—Ç–µ—Ä–Ω—ã/—á–∏—Å–ª–∞.
	‚Ä¢	GPT = —Å–º—ã—Å–ª/–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ/—Ç–µ–∫—Å—Ç—ã.
	‚Ä¢	–û–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å–≤—è–∑–∫–æ–π: ML –æ—Ç–±–∏—Ä–∞–µ—Ç –∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç, GPT –æ–±—ä—è—Å–Ω—è–µ—Ç –∏ —Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ—Ç.

‚∏ª

D2. –†–∞–∑–º–µ—Ç–∫–∞ –∏ —Ç–∞—Ä–≥–µ—Ç—ã (labels)

–¢–µ–∫—É—â–∏–µ –∏ –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ç–∞—Ä–≥–µ—Ç—ã:
	‚Ä¢	is_target ‚Äî —É–∂–µ –µ—Å—Ç—å (—Ü–µ–ª–µ–≤–∞—è/–Ω–µ—Ü–µ–ª–µ–≤–∞—è).
	‚Ä¢	outcome ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫ {record, lead_no_record, info_only}.
	‚Ä¢	call_success ‚Äî –±–∏–∑–Ω–µ—Å-—Ü–µ–ª—å –¥–ª—è —á–∞—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π.
	‚Ä¢	non_target ‚Äî –≤—Å–µ is_target=0 + –ø—Ä–∞–≤–∏–ª–∞ (–Ω–µ—Ç –∞—É–¥–∏–æ, —Ä–µ–∫–ª–∞–º–∞, –∞–≤—Ç–æ–æ–±–∑–≤–æ–Ω).
	‚Ä¢	cancel_risk ‚Äî –ø–æ —Ñ–∞–∫—Ç–∞–º –≤–∏–∑–∏—Ç–æ–≤/–æ–ø–ª–∞—Ç (–ø–æ–∑–∂–µ, –∫–æ–≥–¥–∞ –±—É–¥—É—Ç –¥–∞–Ω–Ω—ã–µ).

–ó–∞–¥–∞—á–∏:
	1.	–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è outcome.
	2.	–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è non_target (–º—É—Å–æ—Ä).
	3.	–°–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤–≤–æ–¥ –ø–æ–ª—è –ø–æ—Å–µ—â–µ–Ω–∏—è/–æ–ø–ª–∞—Ç—ã –≤ –≤–Ω–µ—à–Ω–µ–π —Å–∏—Å—Ç–µ–º–µ, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º —Å—Ç—Ä–æ–∏—Ç—å cancel_risk.

‚∏ª

D3. –§–∏—á–∞-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥ (–ø–æ —Ç–≤–æ–∏–º –ø–æ–ª—è–º)

–¢–∞–±–ª–∏—á–Ω—ã–µ/–≤—Ä–µ–º–µ–Ω–Ω—ã–µ:
	‚Ä¢	–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: talk_duration, await_sec, duration, audio_size, file_size, download_attempts.
	‚Ä¢	–í—Ä–µ–º—è: context_start_time ‚Üí —á–∞—Å, –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏, —Ä–∞–±–æ—á–∏–µ/–Ω–µ—Ä–∞–±–æ—á–∏–µ —Å–ª–æ—Ç—ã.
	‚Ä¢	–ö–∞–Ω–∞–ª—ã: utm_source_by_number, called_info, caller_info, number_category (one-hot/target encoding).
	‚Ä¢	–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã: has_audio, stt_status, transcription_status, downloaded, error_http_status.
	‚Ä¢	–ü–æ–≤–µ–¥–µ–Ω–∏–µ: —á–∞—Å—Ç–æ—Ç–∞ –∑–≤–æ–Ω–∫–æ–≤ –ø–æ caller_number –∑–∞ 7/30 –¥–Ω–µ–π; —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–≤–æ–Ω–∫–æ–≤.

–û–ø–µ—Ä–∞—Ç–æ—Ä—ã/–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è:
	‚Ä¢	answered_extension, answered_user_id;
	‚Ä¢	–≤—Ä–µ–º—è –¥–æ –æ—Ç–≤–µ—Ç–∞;
	‚Ä¢	–¥–æ–ª—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ —Å–º–µ–Ω–µ (rolling –∞–≥—Ä–µ–≥–∞—Ç—ã 7/30 –¥–Ω–µ–π).

–¢–µ–∫—Å—Ç–æ–≤—ã–µ —Å—É—Ä—Ä–æ–≥–∞—Ç—ã (–±–µ–∑ —Ç—è–∂—ë–ª–æ–≥–æ NLP):
	‚Ä¢	–ø–æ transcript:
	‚Ä¢	–¥–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ (—Å–∏–º–≤–æ–ª—ã/—Å–ª–æ–≤–∞);
	‚Ä¢	–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–ø–ª–∏–∫;
	‚Ä¢	–¥–æ–ª—è —Ä–µ—á–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞/–∫–ª–∏–µ–Ω—Ç–∞;
	‚Ä¢	TF-IDF —Ñ–∏—á–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è;
	‚Ä¢	–º–∞—Ä–∫–µ—Ä—ã —Ñ—Ä–∞–∑: ¬´—Ö–æ—á—É –∑–∞–ø–∏—Å–∞—Ç—å—Å—è¬ª, ¬´—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç¬ª, ¬´–∂–∞–ª–æ–±–∞¬ª;
	‚Ä¢	–ø—Ä–æ—Å—Ç–æ–π —Å–∫–æ—Ä —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (—Å–ª–æ–≤–∞—Ä–∏ / VADER-ru).

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
	‚Ä¢	CatBoost / LightGBM / XGBoost.
	‚Ä¢	–î–ª—è —Ç–µ–º–∞—Ç–∏–∫ ‚Äî BERTopic / LDA.

‚∏ª

D4. –ú–µ—Ç—Ä–∏–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

–†–∞–∑–±–∏–µ–Ω–∏–µ:
	‚Ä¢	–ø–æ –≤—Ä–µ–º–µ–Ω–∏: train ‚Äî –ø—Ä–æ—à–ª—ã–µ –º–µ—Å—è—Ü—ã, test ‚Äî –±–æ–ª–µ–µ —Å–≤–µ–∂–∏–µ.
	‚Ä¢	–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ caller_number/answered_user_id (GroupKFold), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —É—Ç–µ—á–∫–∏.

–ú–µ—Ç—Ä–∏–∫–∏:
	‚Ä¢	Outcome-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä:
	‚Ä¢	macro F1;
	‚Ä¢	PR-AUC –ø–æ –∫–ª–∞—Å—Å—É record.
	‚Ä¢	Non-target:
	‚Ä¢	ROC-AUC;
	‚Ä¢	Precision –ø—Ä–∏ –∑–∞–¥–∞–Ω–Ω–æ–º –ø–æ—Ä–æ–≥–µ (–≤–∞–∂–Ω–æ –Ω–µ –≤—ã–∫–∏–Ω—É—Ç—å —Ü–µ–ª–µ–≤—ã–µ).
	‚Ä¢	Cancel_risk (—Ä–µ–¥–∫–∏–π –∫–ª–∞—Å—Å):
	‚Ä¢	PR-AUC;
	‚Ä¢	Recall –Ω–∞ —Ç–æ–ø-N% –∑–≤–æ–Ω–∫–æ–≤.
	‚Ä¢	–ù–∞–≥—Ä—É–∑–∫–∞ (time-series):
	‚Ä¢	sMAPE;
	‚Ä¢	MASE.

–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –ø–æ—Ä–æ–≥–æ–≤:
	‚Ä¢	–ò—Å—Ö–æ–¥—è –∏–∑ –±–∏–∑–Ω–µ—Å-—Å—Ç–æ–∏–º–æ—Å—Ç–∏ FP –∏ FN (—Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Ç–µ—Ä–∏ –ª–∏–¥–∞ vs —Ç—Ä–∞—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞).

‚∏ª

D5. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ML-–º–æ–¥—É–ª—è

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
	1.	–ë–î (Postgres/Supabase, —É–∂–µ –µ—Å—Ç—å):
	‚Ä¢	call_history, call_scores;
	‚Ä¢	–Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã: ml_features, ml_predictions, ml_models.
	2.	ML-—Å–µ—Ä–≤–∏—Å (–æ—Ç–¥–µ–ª—å–Ω—ã–π Python-—Å–µ—Ä–≤–∏—Å):
	‚Ä¢	FastAPI + CatBoost/LightGBM;
	‚Ä¢	—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
	‚Ä¢	POST /predict/outcome;
	‚Ä¢	POST /predict/target.
	3.	–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è (n8n / Cron):
	‚Ä¢	pipeline:
	‚Ä¢	—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏—á;
	‚Ä¢	–≤—ã–∑–æ–≤ ML-—Å–µ—Ä–≤–∏—Å–∞;
	‚Ä¢	–∑–∞–ø–∏—Å—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.
	4.	LLM-—Å–∫—Ä–∏–ø—Ç—ã (—É–∂–µ –µ—Å—Ç—å):
	‚Ä¢	GPT-–æ—Ü–µ–Ω–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ ML-—Ñ–∏–ª—å—Ç—Ä–∞ (—á–µ—Ä–µ–∑ n8n –∏–ª–∏ –≤–Ω—É—Ç—Ä–∏ Python).
	5.	BI-—Å–ª–æ–π:
	‚Ä¢	Metabase / Data Studio / Power BI –¥–ª—è –¥–∞—à–±–æ—Ä–¥–æ–≤.

‚∏ª

D6. –°—Ö–µ–º–∞ –ë–î –¥–ª—è ML

ml_models ‚Äî —Ä–µ–µ—Å—Ç—Ä –º–æ–¥–µ–ª–µ–π:

CREATE TABLE ml_models (
    model_id       SERIAL PRIMARY KEY,
    model_name     TEXT NOT NULL,      -- 'outcome_classifier'
    version        TEXT NOT NULL,      -- '2025-11-27-v1'
    created_at     TIMESTAMP NOT NULL DEFAULT now(),
    train_start_ts TIMESTAMP,
    train_end_ts   TIMESTAMP,
    metrics_json   JSONB,
    features_json  JSONB,
    is_active      BOOLEAN NOT NULL DEFAULT FALSE
);

ml_features ‚Äî –≤–∏—Ç—Ä–∏–Ω–∞ —Ñ–∏—á:

CREATE TABLE ml_features (
    call_id          BIGINT PRIMARY KEY REFERENCES call_history(id),
    extracted_at     TIMESTAMP NOT NULL DEFAULT now(),
    call_date        TIMESTAMP,
    talk_duration    INTEGER,
    await_sec        INTEGER,
    call_type        TEXT,
    utm_source       TEXT,
    called_info      TEXT,
    caller_info      TEXT,
    context_status   TEXT,
    stt_status       TEXT,
    has_audio        BOOLEAN,
    is_target_label  INTEGER,
    outcome_label    TEXT,
    caller_calls_7d  INTEGER,
    caller_calls_30d INTEGER,
    operator_id      INTEGER,
    operator_calls_7d INTEGER,
    transcript_len   INTEGER,
    num_phrases      INTEGER,
    operator_share   NUMERIC,
    client_share     NUMERIC,
    features_json    JSONB
);

ml_predictions ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–µ–π:

CREATE TABLE ml_predictions (
    prediction_id   SERIAL PRIMARY KEY,
    call_id         BIGINT NOT NULL REFERENCES call_history(id),
    model_name      TEXT NOT NULL,
    model_version   TEXT NOT NULL,
    predicted_label TEXT,
    proba_json      JSONB,
    created_at      TIMESTAMP NOT NULL DEFAULT now()
);

CREATE INDEX idx_ml_predictions_call  ON ml_predictions(call_id);
CREATE INDEX idx_ml_predictions_model ON ml_predictions(model_name, model_version);


‚∏ª

D7. ML-—Å–µ—Ä–≤–∏—Å: —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

–°—Ç–µ–∫:
	‚Ä¢	Python 3.11
	‚Ä¢	FastAPI
	‚Ä¢	CatBoost/LightGBM
	‚Ä¢	pydantic
	‚Ä¢	uvicorn/gunicorn

–ü—Ä–æ–µ–∫—Ç:

ml_service/
  app/
    main.py           # FastAPI app
    config.py
    models/
      outcome_model.cbm
      target_model.cbm
    schemas.py        # Pydantic DTO
    features.py       # raw_row -> feature_vector
    inference.py      # –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ CatBoost/LightGBM
  scripts/
    train_outcome.py
    train_target.py
    dump_to_registry.py
  requirements.txt
  Dockerfile

–ü—Ä–∏–º–µ—Ä DTO (schemas.py):

class CallFeatures(BaseModel):
    call_id: int
    features: Dict[str, float | int | str | None]

class OutcomeRequest(BaseModel):
    calls: List[CallFeatures]

class OutcomePrediction(BaseModel):
    call_id: int
    label: str
    proba: Dict[str, float]
    model_name: str
    model_version: str

class OutcomeResponse(BaseModel):
    predictions: List[OutcomePrediction]

–≠–Ω–¥–ø–æ–∏–Ω—Ç:

POST /predict/outcome
Body: OutcomeRequest
‚Üí OutcomeResponse


‚∏ª

D8. –û–±—É—á–∞—é—â–∏–π –∫–æ–Ω—Ç—É—Ä (offline)

–î–∞—Ç–∞—Å–µ—Ç:
	‚Ä¢	—Å–æ–∑–¥–∞—ë—Ç—Å—è view ml_training_view:

CREATE OR REPLACE VIEW ml_training_view AS
SELECT
    ch.id AS call_id,
    ch.talk_duration,
    ch.await_sec,
    ch.call_type,
    ch.utm_source_by_number AS utm_source,
    ch.called_info,
    ch.caller_info,
    ch.context_status,
    ch.stt_status,
    ch.has_audio,
    cs.is_target,
    cs.outcome
FROM call_history ch
LEFT JOIN call_scores cs ON cs.history_id = ch.id
WHERE ch.stt_status = 'done';

–°–∫—Ä–∏–ø—Ç—ã –æ–±—É—á–µ–Ω–∏—è (scripts/train_outcome.py, train_target.py):
	1.	–ü–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –∫ –ë–î.
	2.	–í—ã–≥—Ä—É–∂–∞—é—Ç ml_training_view –≤ pandas.
	3.	–î–µ–ª–∞—é—Ç time-based split.
	4.	–û–±—É—á–∞—é—Ç CatBoost/LightGBM.
	5.	–°–æ—Ö—Ä–∞–Ω—è—é—Ç –º–æ–¥–µ–ª—å (.cbm) –≤ models/.
	6.	–ü–∏—à—É—Ç –∑–∞–ø–∏—Å—å –≤ ml_models —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏ —Å–ø–∏—Å–∫–æ–º —Ñ–∏—á–µ–π.

‚∏ª

D9. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ML ‚Üí GPT

–ü–∞–π–ø–ª–∞–π–Ω:
	1.	Feature extraction:
	‚Ä¢	–≤—ã–±–∏—Ä–∞–µ—Ç –∑–≤–æ–Ω–∫–∏ —Å stt_status='done', –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ ml_features;
	‚Ä¢	—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ñ–∏—á–∏ ‚Üí –≤—Å—Ç–∞–≤–ª—è–µ—Ç –≤ ml_features.
	2.	Inference:
	‚Ä¢	n8n:
	‚Ä¢	–≤—ã–±–∏—Ä–∞–µ—Ç call_id –∏–∑ ml_features, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç ml_predictions –ø–æ –Ω—É–∂–Ω–æ–π –º–æ–¥–µ–ª–∏;
	‚Ä¢	–∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç POST /predict/outcome –±–∞—Ç—á–∞–º–∏;
	‚Ä¢	—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ ml_predictions.
	3.	–°–≤—è–∑–∫–∞ —Å GPT:
	‚Ä¢	–ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º GPT:
	‚Ä¢	–ø—Ä–æ–≤–µ—Ä—è—Ç—å ml_predictions:
	‚Ä¢	–µ—Å–ª–∏ non_target –∏–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ü–µ–ª–µ–≤–æ–≥–æ –∏—Å—Ö–æ–¥–∞ –Ω–∏–∑–∫–∞—è ‚Äî –ª–∏–±–æ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å, –ª–∏–±–æ —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑;
	‚Ä¢	–¥–ª—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –∑–≤–æ–Ω–∫–æ–≤ ‚Äî –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π GPT-–∞–Ω–∞–ª–∏–∑.
	‚Ä¢	GPT-—Å–∫—Ä–∏–ø—Ç –º–æ–∂–µ—Ç –ø–æ–¥—Ç—è–≥–∏–≤–∞—Ç—å ml_predictions –¥–ª—è –∫–∞–∂–¥–æ–≥–æ call_id –ø–µ—Ä–µ–¥ –∞–Ω–∞–ª–∏–∑–æ–º.

‚∏ª

D10. –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ –ø–æ ML (—ç—Ç–∞–ø—ã)

–≠—Ç–∞–ø 1 ‚Äî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ö–µ–º—ã (1‚Äì2 –¥–Ω—è):
	‚Ä¢	–¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã ml_models, ml_features, ml_predictions;
	‚Ä¢	—Å–æ–±—Ä–∞—Ç—å ml_training_view;
	‚Ä¢	—Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—É—é –≤—ã–≥—Ä—É–∑–∫—É –∏ –±–∞–∑–æ–≤—É—é EDA.

–≠—Ç–∞–ø 2 ‚Äî –ë–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ (3‚Äì5 –¥–Ω–µ–π):
	‚Ä¢	—Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å train_outcome.py, train_target.py;
	‚Ä¢	–ø–æ–ª—É—á–∏—Ç—å baseline-–º–µ—Ç—Ä–∏–∫–∏;
	‚Ä¢	–∑–∞–ø–∏—Å–∞—Ç—å –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–µ–π –≤ ml_models.

–≠—Ç–∞–ø 3 ‚Äî ML-—Å–µ—Ä–≤–∏—Å (2‚Äì3 –¥–Ω—è):
	‚Ä¢	–ø–æ–¥–Ω—è—Ç—å FastAPI-—Å–µ—Ä–≤–∏—Å;
	‚Ä¢	–¥–æ–±–∞–≤–∏—Ç—å health-check;
	‚Ä¢	–∑–∞–≤–µ—Ä–Ω—É—Ç—å –≤ Docker –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å.

–≠—Ç–∞–ø 4 ‚Äî –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ–¥–æ–º (3‚Äì4 –¥–Ω—è):
	‚Ä¢	workflow –≤ n8n:
	‚Ä¢	–≥–µ–Ω–µ—Ä–∞—Ü–∏—è ml_features;
	‚Ä¢	–≤—ã–∑–æ–≤ ML-—Å–µ—Ä–≤–∏—Å–∞;
	‚Ä¢	–∑–∞–ø–∏—Å—å –≤ ml_predictions.
	‚Ä¢	—Å–ª–µ–¥–∏—Ç—å –∑–∞ –Ω–∞–≥—Ä—É–∑–∫–æ–π –Ω–∞ –ë–î.

–≠—Ç–∞–ø 5 ‚Äî –°–≤—è–∑–∫–∞ —Å GPT (2‚Äì3 –¥–Ω—è):
	‚Ä¢	–æ–±–Ω–æ–≤–∏—Ç—å GPT-—Å–∫—Ä–∏–ø—Ç –¥–ª—è —É—á—ë—Ç–∞ ML-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π;
	‚Ä¢	–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —á–∞—Å—Ç–∏ –±–∞–∑—ã.

‚∏ª

D11. –†–∏—Å–∫–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å (ML)
	‚Ä¢	–î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ ‚Üí class_weight, oversampling.
	‚Ä¢	–£—Ç–µ—á–∫–∏ –±—É–¥—É—â–µ–≥–æ ‚Üí —Å—Ç—Ä–æ–≥–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏.
	‚Ä¢	–®—É–º STT ‚Üí –Ω–µ –¥–µ–ª–∞—Ç—å —Å—Ä–∞–∑—É —Å–ª–æ–∂–Ω—ã–π NLP, –¥–µ—Ä–∂–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∏—á–∏ –ø—Ä–æ—Å—Ç—ã–º–∏.
	‚Ä¢	–î—Ä–µ–π—Ñ –¥–∞–Ω–Ω—ã—Ö ‚Üí –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å (PSI –ø–æ –∫–ª—é—á–µ–≤—ã–º —Ñ–∏—á–∞–º).
	‚Ä¢	PII ‚Üí –Ω–æ–º–µ—Ä–∞ –∏ —Å—ã—Ä—ã–µ —Ç–µ–∫—Å—Ç—ã –Ω–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ ML-—Å–µ—Ä–≤–∏—Å–µ.

‚∏ª




–°–¢–†–£–ö–¢–£–†–ê –¢–ê–ë–õ–ò–¶–´ —Åall_scores –æ—Ç–∫—É–¥–∞ –∑–∞–±–∏—Ä–∞–µ–º –∑–≤–æ–Ω–∫–∏
	#	–ò–º—è	–¢–∏–ø	–°—Ä–∞–≤–Ω–µ–Ω–∏–µ	–ê—Ç—Ä–∏–±—É—Ç—ã	Null	–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é	–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏	–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ	–î–µ–π—Å—Ç–≤–∏–µ
	1	id –ü–µ—Ä–≤–∏—á–Ω—ã–π	int			–ù–µ—Ç	–ù–µ—Ç		AUTO_INCREMENT	–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	2	history_id –ò–Ω–¥–µ–∫—Å	int		UNSIGNED	–ù–µ—Ç	–ù–µ—Ç			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	3	call_score	float			–ù–µ—Ç	–ù–µ—Ç			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	4	score_date	datetime			–ù–µ—Ç	–ù–µ—Ç			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	5	called_info	varchar(255)	utf8mb4_general_ci		–î–∞	NULL			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	6	call_date –ò–Ω–¥–µ–∫—Å	datetime			–î–∞	NULL			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	7	call_type	varchar(50)	utf8mb4_general_ci		–î–∞	NULL			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	8	talk_duration	smallint		UNSIGNED	–î–∞	NULL	–í—Ä–µ–º—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞		–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	9	call_success	varchar(50)	utf8mb4_general_ci		–î–∞	NULL			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	10	transcript	mediumtext	utf8mb4_general_ci		–î–∞	NULL			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	11	result	mediumtext	utf8mb4_general_ci		–î–∞	NULL			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	12	caller_info	varchar(255)	utf8mb4_general_ci		–ù–µ—Ç	–ù–µ—Ç			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	13	caller_number	varchar(255)	utf8mb4_unicode_ci		–î–∞	NULL			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	14	called_number	varchar(255)	utf8mb4_unicode_ci		–î–∞	NULL			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	15	utm_source_by_number	mediumtext	utf8mb4_unicode_ci		–î–∞	NULL			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	16	call_category	mediumtext	utf8mb4_general_ci		–ù–µ—Ç	–ù–µ—Ç			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	17	number_category	int			–ù–µ—Ç	–ù–µ—Ç			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	18	number_checklist	int			–î–∞	NULL			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	19	category_checklist	mediumtext	utf8mb4_general_ci		–î–∞	NULL			–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	20	is_target –ò–Ω–¥–µ–∫—Å	tinyint(1)			–ù–µ—Ç	0	1 ‚Äî —Ü–µ–ª–µ–≤–æ–π –∑–≤–æ–Ω–æ–∫, 0 ‚Äî –Ω–µ—Ü–µ–ª–µ–≤–æ–π		–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	21	outcome –ò–Ω–¥–µ–∫—Å	varchar(32)	utf8mb4_general_ci		–î–∞	NULL	–ò—Ç–æ–≥ –∑–≤–æ–Ω–∫–∞ –≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ: record / lead_no_record / info_only / non_target		–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	22	requested_service_id –ò–Ω–¥–µ–∫—Å	int		UNSIGNED	–î–∞	NULL	–°—Å—ã–ª–∫–∞ –Ω–∞ services.service_id (–µ—Å–ª–∏ –Ω–∞—à–ª–∏ —É—Å–ª—É–≥—É –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ)		–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	23	requested_service_name	varchar(255)	utf8mb4_general_ci		–î–∞	NULL	–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ (–∫–∞–∫ –≤ services.name, –¥–ª—è –ª—é–¥–µ–π)		–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	24	requested_doctor_id –ò–Ω–¥–µ–∫—Å	int		UNSIGNED	–î–∞	NULL	–°—Å—ã–ª–∫–∞ –Ω–∞ doctors.doctor_id (–µ—Å–ª–∏ –Ω–∞—à–ª–∏ –≤—Ä–∞—á–∞ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ)		–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	25	requested_doctor_name	varchar(255)	utf8mb4_general_ci		–î–∞	NULL	–§–ò–û –≤—Ä–∞—á–∞, –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ—Å–∏–ª –ø–∞—Ü–∏–µ–Ω—Ç (–∫–∞–∫ –≤ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–µ)		–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	26	requested_doctor_speciality	varchar(255)	utf8mb4_general_ci		–î–∞	NULL	–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –≤—Ä–∞—á–∞ (–Ω–µ–≤—Ä–æ–ª–æ–≥, —Ç–µ—Ä–∞–ø–µ–≤—Ç –∏ —Ç.–¥.)		–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
	27	refusal_reason	varchar(255)	utf8mb4_general_ci		–î–∞	NULL	–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–∞–∑–∞, –µ—Å–ª–∏ –∏—Å—Ö–æ–¥ –Ω–µ –∑–∞–ø–∏—Å—å		–ò–∑–º–µ–Ω–∏—Ç—å –ò–∑–º–µ–Ω–∏—Ç—å	–£–¥–∞–ª–∏—Ç—å –£–¥–∞–ª–∏—Ç—å	
